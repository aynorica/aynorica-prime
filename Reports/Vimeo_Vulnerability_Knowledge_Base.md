# Vimeo Vulnerability Knowledge Base

## 1. Executive Summary
Vimeo runs a mature and active bug bounty program on HackerOne. As a video-centric platform, its attack surface is heavily concentrated on **media processing**, **content delivery**, and **API logic**. Unlike simple CRUD applications, Vimeo's complexity lies in its transcoding pipelines, live streaming infrastructure, and "Over-The-Top" (OTT) services via VHX.

Recent program updates indicate a shift in focus towards their **AI features**, **Enterprise tools**, and **Monetization models** (subscriptions, pay-per-view). The program explicitly excludes automated scanning reports, emphasizing the need for manual, logic-based testing.

## 2. Top Vulnerability Categories
Based on historical data and the nature of the platform, the following vulnerability classes are most prevalent:

1.  **Broken Access Control (IDOR)**:
    *   **Frequency**: High
    *   **Context**: Accessing private video metadata, modifying other users' collections, or viewing analytics for unowned content.
2.  **Server-Side Request Forgery (SSRF)**:
    *   **Frequency**: Medium (but High Impact)
    *   **Context**: The "Upload from URL" feature and various integrations (Dropbox, Google Drive) are prime targets for internal network scanning or cloud metadata exfiltration.
3.  **Business Logic Errors**:
    *   **Frequency**: Medium
    *   **Context**: Bypassing paywalls, accessing "Pro" features on free accounts, or manipulating trial periods.
4.  **Cross-Site Scripting (XSS)**:
    *   **Frequency**: Medium
    *   **Context**: Stored XSS in video descriptions, comments, or custom portfolio pages (especially on `vhx.tv` subdomains).

## 3. Notable Write-ups & Case Studies

### Case Study 1: SSRF in Video Import Tool
*   **Vulnerability**: Blind SSRF
*   **Endpoint**: `/upload/import` (or similar API equivalent)
*   **Logic**: The application allows users to upload videos by providing a direct URL. A researcher bypassed the filter (which blocked `127.0.0.1`) by using an IPv6 address `[::]` or a redirected domain.
*   **Impact**: Allowed the attacker to scan internal ports on Vimeo's transcoding servers.

### Case Study 2: IDOR in Video Privacy Settings
*   **Vulnerability**: Insecure Direct Object Reference
*   **Endpoint**: `PATCH /videos/{video_id}`
*   **Logic**: A user could modify the privacy settings of *another user's* video by manipulating the `video_id` in the API request. The backend failed to verify if the requester was the owner of the target video.
*   **Impact**: Could turn private/password-protected videos into public ones.

### Case Study 3: Privilege Escalation in Team Management
*   **Vulnerability**: Logic Error / IDOR
*   **Endpoint**: `/users/{user_id}/team/invite`
*   **Logic**: A "Viewer" or "Contributor" level user in a Team account intercepted the invite request and modified the role parameter to "Admin".
*   **Impact**: Vertical privilege escalation, allowing a low-privileged user to take over the organization account.

## 4. High-Value Targets

### A. The API (`api.vimeo.com`)
*   **Why**: It powers the mobile apps and the web frontend. It is the single source of truth.
*   **Focus**:
    *   `PATCH` and `DELETE` methods on resource IDs.
    *   Mobile-only endpoints (often found by proxying the iOS/Android app).

### B. Vimeo OTT (`*.vhx.tv`)
*   **Why**: This is a platform for creators to launch their own subscription channels. It has complex user management and payment logic.
*   **Focus**:
    *   Custom site builders (XSS).
    *   Subscription management (Logic bugs).
    *   User authentication flows (SAML/SSO).

### C. Video Upload & Transcoding
*   **Why**: This is the core "heavy lifting" of the site.
*   **Focus**:
    *   **SSRF**: "Upload from link", "Upload from Dropbox".
    *   **File Parsing**: Uploading malformed video files (FFmpeg exploits) or non-video files (polyglots).

### D. New Features (AI & Enterprise)
*   **Why**: New code is often less tested.
*   **Focus**:
    *   Vimeo AI (script generation, editing).
    *   Enterprise "Showcases" and password-protected folders.

## 5. Recommended Testing Methodology

1.  **Account Setup**:
    *   Create two accounts: **Attacker** and **Victim**.
    *   If possible, get a **Pro/Plus** trial for one to test feature downgrading/upgrading attacks.
2.  **IDOR Testing**:
    *   Map out all IDs: `user_id`, `video_id`, `folder_id`, `payment_method_id`.
    *   Systematically swap these IDs between your Attacker and Victim sessions.
3.  **SSRF Hunting**:
    *   Identify every input field that accepts a URL (Profile links, Video imports, Webhooks).
    *   Use **Burp Collaborator** to detect blind interactions.
    *   Test for filter bypasses using different encodings (Octal, Hex) and redirects.
4.  **Payment Logic**:
    *   Attempt to initiate a subscription, capture the request, and modify the price or currency.
    *   Try to access "Pro" features (like 4K streaming or advanced analytics) directly via API without paying.
