# Vimeo Vulnerability Knowledge Base

## 1. Executive Summary
Vimeo is a mature target with a hardened perimeter. Simple automated scans will yield nothing. Success requires deep understanding of their specific features: **Video Transcoding**, **OTT (Over-The-Top) Services**, and **Team/Enterprise Management**.

**Key Insight**: The complexity of managing video privacy states (Public, Private, Password, Unlisted, Domain-Restricted) creates edge cases where authorization checks fail.

## 2. Top Vulnerability Categories

### A. Broken Access Control (IDOR) - *High Frequency*
*   **Concept**: Vimeo relies heavily on numeric or UUID-based identifiers for videos, users, and folders.
*   **Pattern**: `GET /api/videos/{video_id}` might check permissions, but `POST /api/videos/{video_id}/comments` or `PUT /api/videos/{video_id}/settings` might not.
*   **Specific Target**: "Private" or "Password Protected" videos. Can you fetch the thumbnail? The metadata? The download link?

### B. Server-Side Request Forgery (SSRF) - *Critical Impact*
*   **Concept**: Vimeo must fetch video files from external URLs to support "Upload from URL" or "Import from Dropbox/Drive".
*   **Pattern**: The system takes a user-supplied URL and makes a backend HTTP request.
*   **Bypass Techniques**:
    *   DNS Rebinding.
    *   Redirects (301/302) to internal IPs (169.254.169.254, 127.0.0.1).
    *   IPv6 variations (e.g., `[::1]`).
    *   Alternative protocols (`file://`, `gopher://`, `ffmpeg://`).

### C. Business Logic & Payment Bypasses
*   **Concept**: Vimeo sells subscriptions (Plus, Pro, Business, Premium).
*   **Pattern**:
    *   **Feature Downgrade**: Subscribe, use a Pro feature (e.g., set domain restriction), cancel subscription. Does the feature persist?
    *   **Trial Abuse**: Infinite trial loops via email aliases (`user+1@gmail.com`).
    *   **Team Seats**: Adding more team members than paid for by manipulating the invite request.

### D. Video Processing Vulnerabilities
*   **Concept**: Uploaded files are processed by FFmpeg or similar libraries.
*   **Pattern**:
    *   **HLS/Dash Manipulation**: Tampering with manifest files (.m3u8) to point to internal resources.
    *   **ImageTragick / Image Parsing**: Malformed thumbnails or cover art.

## 3. Notable Case Studies (Simulated based on common patterns)

### Case Study 1: The "Private" Video Thumbnail Leak
*   **Vulnerability**: IDOR on Thumbnail Generation.
*   **Logic**: The endpoint to generate a preview image for a video didn't check if the requester had the password for the video.
*   **Impact**: Attackers could see visual content of private videos.

### Case Study 2: SSRF via "Upload from URL"
*   **Vulnerability**: Blind SSRF.
*   **Logic**: User provides a URL to upload. The validator checks if it's a valid video file extension. The attacker hosts a server that redirects `video.mp4` to `http://169.254.169.254/latest/meta-data/`.
*   **Impact**: AWS Credential Leak.

### Case Study 3: Team Role Escalation
*   **Vulnerability**: Parameter Tampering.
*   **Logic**: Admin invites User B as "Viewer". The POST request contains `role=viewer`. Attacker intercepts and changes to `role=admin`. Backend accepts it without verifying if the plan supports more admins.

## 4. High-Value Targets & Endpoints

| Component | Endpoint / Feature | What to Test |
| :--- | :--- | :--- |
| **API** | `api.vimeo.com` | IDOR on all `PUT`/`DELETE` methods. |
| **Upload** | `/upload/link` | SSRF, File parsing bugs. |
| **OTT** | `*.vhx.tv` | Auth bypass, Subscription logic. |
| **Live** | Live Streaming Setup | Stream key leakage, Quota bypass. |
| **Teams** | Team Management | Privilege Escalation, Seat limit bypass. |

## 5. Recommended Testing Methodology

### Phase 1: Recon & Account Setup
1.  Create **two** accounts: `attacker` and `victim`.
2.  Upgrade one to a **Trial Pro** account (if possible) to unlock features.
3.  Map the API: Use Burp Suite to browse the site and capture the API schema.

### Phase 2: The "Privacy Matrix" Test
1.  Upload a video on `victim` account.
2.  Set privacy to "Private" (Only me).
3.  Iterate through ALL API endpoints using `attacker` session token but `victim`'s `video_id`.
4.  Repeat for "Password Protected" and "Domain Restricted".

### Phase 3: The "Upload" Fuzz
1.  Locate "Upload from URL".
2.  Use Burp Collaborator.
3.  Test for SSRF using redirects and DNS rebinding.
4.  Test for Image/Video parsing bugs by uploading malformed headers.

### Phase 4: Logic & Payments
1.  Start a subscription flow.
2.  Intercept the payment confirmation.
3.  Try to modify `price`, `currency`, or `plan_id`.
4.  Test cancellation flows for race conditions.
